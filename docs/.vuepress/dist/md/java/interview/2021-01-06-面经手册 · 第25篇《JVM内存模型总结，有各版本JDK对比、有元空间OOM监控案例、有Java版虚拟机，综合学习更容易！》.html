<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>面经手册 · 第25篇《JVM内存模型总结，有各版本JDK对比、有元空间OOM监控案例、有Java版虚拟机，综合学习更容易！》 | bugstack 虫洞栈</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/favicon.ico">
    <script charset="utf-8" async="async" src="/js/jquery.min.js"></script>
    <script charset="utf-8" async="async" src="/js/global.js"></script>
    <script charset="utf-8" async="async" src="/js/fingerprint2.min.js"></script>
    <script>
              var _hmt = _hmt || [];
              (function() {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?0b31b4c146bf7126aed5009e1a4a11c8";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
              })();
            </script>
    <meta name="description" content="包含: Java 基础，面经手册，Netty4.x，手写Spring，用Java实现JVM，重学Java设计模式，SpringBoot中间件开发，IDEA插件开发，DDD系统架构项目开发，字节码编程...">
    <meta property="og:title" content="面经手册 · 第25篇《JVM内存模型总结，有各版本JDK对比、有元空间OOM监控案例、有Java版虚拟机，综合学习更容易！》">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html">
    <meta name="twitter:title" content="面经手册 · 第25篇《JVM内存模型总结，有各版本JDK对比、有元空间OOM监控案例、有Java版虚拟机，综合学习更容易！》">
    <meta name="twitter:url" content="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="robots" content="all">
    <meta name="author" content="小傅哥">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="keywords" content="bugstack 虫洞栈, DDD抽奖系统，数据结构，重学Java设计模式, 字节码编程, 中间件, 手写Spring, 手写MyBatis，Java基础, 面经手册，面试题，API网关，SpringBoot Stater">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.34a27db0.css" as="style"><link rel="preload" href="/assets/css/styles.css?v=1686664442105" as="style"><link rel="preload" href="/assets/js/cg-styles.js?v=1686664442105" as="script"><link rel="preload" href="/assets/js/cg-app.js?v=1686664442105" as="script"><link rel="preload" href="/assets/js/cg-3.js?v=1686664442105" as="script"><link rel="preload" href="/assets/js/cg-4.js?v=1686664442105" as="script"><link rel="preload" href="/assets/js/cg-55.js?v=1686664442105" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.34a27db0.css"><link rel="stylesheet" href="/assets/css/styles.css?v=1686664442105">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">bugstack 虫洞栈</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/interview/2020-07-28-面经手册 · 开篇《面试官都问我啥》.html" class="nav-link">
  面经手册
</a></li><li class="dropdown-item"><!----> <a href="/md/java/develop-jvm/2019-05-01-用Java实现JVM第一章《命令行工具》.html" class="nav-link">
  用Java实现JVM
</a></li><li class="dropdown-item"><!----> <a href="/md/java/core/2020-01-06-[源码分析]咋嘞？你的IDEA过期了吧！加个Jar包就破解了，为什么？.html" class="nav-link">
  基础技术
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/assembly/middleware/统一白名单组件.html" class="nav-link">
  springboot中间件
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/interview/2020-07-28-面经手册 · 开篇《面试官都问我啥》.html" class="nav-link">
  面经手册
</a></li><li class="dropdown-item"><!----> <a href="/md/java/develop-jvm/2019-05-01-用Java实现JVM第一章《命令行工具》.html" class="nav-link">
  用Java实现JVM
</a></li><li class="dropdown-item"><!----> <a href="/md/java/core/2020-01-06-[源码分析]咋嘞？你的IDEA过期了吧！加个Jar包就破解了，为什么？.html" class="nav-link">
  基础技术
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/assembly/middleware/统一白名单组件.html" class="nav-link">
  springboot中间件
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第 1 章 谈谈面试</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/interview/2020-07-28-面经手册 · 开篇《面试官都问我啥》.html" class="sidebar-link">面经手册 · 开篇《面试官都问我啥》</a></li><li><a href="/md/java/interview/2020-07-30-面经手册 · 第1篇《认知自己的技术栈盲区》.html" class="sidebar-link">面经手册 · 第1篇《认知自己的技术栈盲区》</a></li><li><a href="/md/java/interview/2021-03-07-面试现场：小伙伴美团一面的分享和分析[含解答].html" class="sidebar-link">面试现场：小伙伴美团一面的分享和分析(含解答)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第 2 章 数据结构和算法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/interview/2020-08-04-面经手册 · 第2篇《数据结构，HashCode为什么使用31作为乘数？》.html" class="sidebar-link">面经手册 · 第2篇《数据结构，HashCode为什么使用31作为乘数？》</a></li><li><a href="/md/java/interview/2020-08-07-面经手册 · 第3篇《HashMap核心知识，扰动函数、负载因子、扩容链表拆分，深度学习》.html" class="sidebar-link">面经手册 · 第3篇《HashMap核心知识，扰动函数、负载因子、扩容链表拆分，深度学习》</a></li><li><a href="/md/java/interview/2020-08-13-面经手册 · 第4篇《HashMap数据插入、查找、删除、遍历，源码分析》.html" class="sidebar-link">面经手册 · 第4篇《HashMap数据插入、查找、删除、遍历，源码分析》</a></li><li><a href="/md/java/interview/2020-08-16-面经手册 · 第5篇《看图说话，讲解2-3平衡树「红黑树的前身」》.html" class="sidebar-link">面经手册 · 第5篇《看图说话，讲解2-3平衡树「红黑树的前身」》</a></li><li><a href="/md/java/interview/2020-08-20-面经手册 · 第6篇《带着面试题学习红黑树操作原理，解析什么时候染色、怎么进行旋转、与2-3树有什么关联》.html" class="sidebar-link">面经手册 · 第6篇《带着面试题学习红黑树操作原理，解析什么时候染色、怎么进行旋转、与2-3树有什么关联》</a></li><li><a href="/md/java/interview/2020-08-27-面经手册 · 第7篇《ArrayList也这么多知识？一个指定位置插入就把谢飞机面晕了！》.html" class="sidebar-link">面经手册 · 第7篇《ArrayList也这么多知识？一个指定位置插入就把谢飞机面晕了！》</a></li><li><a href="/md/java/interview/2020-08-30-面经手册 · 第8篇《LinkedList插入速度比ArrayList快？你确定吗？》.html" class="sidebar-link">面经手册 · 第8篇《LinkedList插入速度比ArrayList快？你确定吗？》</a></li><li><a href="/md/java/interview/2020-09-03-面经手册 · 第9篇《队列是什么？什么是双端队列、延迟对列、阻塞队列，全是知识盲区！》.html" class="sidebar-link">面经手册 · 第9篇《队列是什么？什么是双端队列、延迟对列、阻塞队列，全是知识盲区！》</a></li><li><a href="/md/java/interview/2020-09-10-面经手册 · 第10篇《扫盲java.util.Collections工具包，学习排序、二分、洗牌、旋转算法》.html" class="sidebar-link">面经手册 · 第10篇《扫盲java.util.Collections工具包，学习排序、二分、洗牌、旋转算法》</a></li><li><a href="/md/java/interview/2020-09-17-面经手册 · 第11篇《StringBuilder 比 String 快？空嘴白牙的，证据呢！》.html" class="sidebar-link">面经手册 · 第11篇《StringBuilder 比 String 快？空嘴白牙的，证据呢！》</a></li><li><a href="/md/java/interview/2020-09-23-面经手册 · 第12篇《面试官，ThreadLocal 你要这么问，我就挂了！》.html" class="sidebar-link">面经手册 · 第12篇《面试官，ThreadLocal 你要这么问，我就挂了！》</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第 3 章 并发和锁</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/interview/2020-10-14-面经手册 · 第13篇《除了JDK、CGLIB，还有3种类代理方式？面试又卡住！》.html" class="sidebar-link">面经手册 · 第13篇《除了JDK、CGLIB，还有3种类代理方式？面试又卡住！》</a></li><li><a href="/md/java/interview/2020-10-21-面经手册 · 第14篇《volatile 怎么实现的内存可见？没有 volatile 一定不可见吗？》.html" class="sidebar-link">面经手册 · 第14篇《volatile 怎么实现的内存可见？没有 volatile 一定不可见吗？》</a></li><li><a href="/md/java/interview/2020-10-28-面经手册 · 第15篇《码农会锁，synchronized 解毒，剖析源码深度分析！》.html" class="sidebar-link">面经手册 · 第15篇《码农会锁，synchronized 解毒，剖析源码深度分析！》</a></li><li><a href="/md/java/interview/2020-11-04-面经手册 · 第16篇《码农会锁，ReentrantLock之公平锁讲解和实现》.html" class="sidebar-link">面经手册 · 第16篇《码农会锁，ReentrantLock之公平锁讲解和实现》</a></li><li><a href="/md/java/interview/2020-11-11-面经手册 · 第17篇《码农会锁，ReentrantLock之AQS原理分析和实践使用》.html" class="sidebar-link">面经手册 · 第17篇《码农会锁，ReentrantLock之AQS原理分析和实践使用》</a></li><li><a href="/md/java/interview/2020-11-18-面经手册 · 第18篇《AQS 共享锁，Semaphore、CountDownLatch，听说数据库连接池可以用到！》.html" class="sidebar-link">面经手册 · 第18篇《AQS 共享锁，Semaphore、CountDownLatch，听说数据库连接池可以用到！》</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第 4 章 多线程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/interview/2020-11-25-面经手册 · 第19篇《Thread.start() ，它是怎么让线程启动的呢？》.html" class="sidebar-link">面经手册 · 第19篇《Thread.start() ，它是怎么让线程启动的呢？》</a></li><li><a href="/md/java/interview/2020-12-02-面经手册 · 第20篇《Thread 线程，状态转换、方法使用、原理分析》.html" class="sidebar-link">面经手册 · 第20篇《Thread 线程，状态转换、方法使用、原理分析》</a></li><li><a href="/md/java/interview/2020-12-09-面经手册 · 第21篇《手写线程池，对照学习ThreadPoolExecutor线程池实现原理！》.html" class="sidebar-link">面经手册 · 第21篇《手写线程池，对照学习ThreadPoolExecutor线程池实现原理！》</a></li><li><a href="/md/java/interview/2020-12-16-面经手册 · 第22篇《线程池的介绍和使用，以及基于jvmti设计非入侵监控》.html" class="sidebar-link">面经手册 · 第22篇《线程池的介绍和使用，以及基于jvmti设计非入侵监控》</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>第 5 章 JVM 虚拟机</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/interview/2020-12-23-面经手册 · 第23篇《JDK、JRE、JVM，是什么关系？》.html" class="sidebar-link">面经手册 · 第23篇《JDK、JRE、JVM，是什么关系？》</a></li><li><a href="/md/java/interview/2020-12-30-面经手册 · 第24篇《为了搞清楚类加载，竟然手撸JVM！》.html" class="sidebar-link">面经手册 · 第24篇《为了搞清楚类加载，竟然手撸JVM！》</a></li><li><a href="/md/java/interview/2021-01-06-面经手册 · 第25篇《JVM内存模型总结，有各版本JDK对比、有元空间OOM监控案例、有Java版虚拟机，综合学习更容易！》.html" class="active sidebar-link">面经手册 · 第25篇《JVM内存模型总结，有各版本JDK对比、有元空间OOM监控案例、有Java版虚拟机，综合学习更容易！》</a></li><li><a href="/md/java/interview/2021-01-13-面经手册 · 第26篇《JVM故障处理工具，使用总结》.html" class="sidebar-link">面经手册 · 第26篇《JVM故障处理工具，使用总结》</a></li><li><a href="/md/java/interview/2021-01-20-面经手册 · 第27篇《JVM 判断对象已死，实践验证GC回收》.html" class="sidebar-link">面经手册 · 第27篇《JVM 判断对象已死，实践验证GC回收》</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第 6 章 Spring</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/interview/2021-03-30-面经手册 · 第28篇《你说，怎么把Bean塞到Spring容器》.html" class="sidebar-link">面经手册 · 第28篇《你说，怎么把Bean塞到Spring容器？》</a></li><li><a href="/md/java/interview/2021-04-07-面经手册 · 第29篇《Spring IOC 特性有哪些，不会读不懂源码！》.html" class="sidebar-link">面经手册 · 第29篇《Spring IOC 特性有哪些，不会读不懂源码！》</a></li><li><a href="/md/java/interview/2021-04-18-面经手册 · 第30篇《关于 Spring 中 getBean 的全流程源码解析》.html" class="sidebar-link">面经手册 · 第30篇《关于 Spring 中 getBean 的全流程源码解析》</a></li><li><a href="/md/java/interview/2021-05-05-面经手册 · 第31篇《Spring Bean IOC、AOP 循环依赖解读》.html" class="sidebar-link">面经手册 · 第31篇《Spring Bean IOC、AOP 循环依赖解读》</a></li></ul></section></li></ul> </aside> <div><main class="page"> <div class="theme-default-content content__default"><h1 id="面经手册-·-第25篇《jvm内存模型总结-有各版本jdk对比、有元空间oom监控案例、有java版虚拟机-综合学习更容易-》"><a href="#面经手册-·-第25篇《jvm内存模型总结-有各版本jdk对比、有元空间oom监控案例、有java版虚拟机-综合学习更容易-》" class="header-anchor">#</a> 面经手册 · 第25篇《JVM内存模型总结，有各版本JDK对比、有元空间OOM监控案例、有Java版虚拟机，综合学习更容易！》</h1> <p>作者：小傅哥
<br>博客：<a href="https://bugstack.cn" target="_blank" rel="noopener noreferrer">https://bugstack.cn<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>沉淀、分享、成长，让自己和他人都能有所收获！😄</p></blockquote> <h2 id="一、前言"><a href="#一、前言" class="header-anchor">#</a> 一、前言</h2> <p><code>看了一篇文章30岁有多难！</code></p> <p>每篇文章的开篇总喜欢写一些，从个人视角看这个世界的感悟。</p> <p>最近看到一篇文章，<code>30岁有多难</code>。文中的一些主人公好像在学业、工作、生活、爱情等方面都过的都不如意。要不是错过这，要不是走错那。总结来看，就像是很倒霉的一群倒霉蛋儿在跟生活对干！</p> <p>但其实每个人可能都遇到过生活中最难的时候，或早或晚。就像我刚毕业不久时一连串遇到；<code>冬天里丢过第一部手机</code>、<code>修一个进了水的电脑</code>、<code>租的房子第一次被骗</code>，一连串下来头一次要赶在工资没发的时候，选择少吃早饭还是午饭，看看能扛过去那顿。</p> <p>哈哈哈哈哈，现在想想还挺有意思的，不过这些乱遭的事很多是自己的意识和能力不足时做出的错误选择而导致的。</p> <p>人那，想开车就要考驾照，想走远就要有能力。多提升认知，多拓宽眼界！<code>生活的意义就是不断的更新自己！</code></p> <h2 id="二、面试题"><a href="#二、面试题" class="header-anchor">#</a> 二、面试题</h2> <p><code>谢飞机，小记！</code>，冬风吹、战鼓擂。被窝里，谁怕谁。</p> <p><strong>谢飞机</strong>：歪？大哥，你在吗？</p> <p><strong>面试官</strong>：咋了，大周末的，这么早打电话！？</p> <p><strong>谢飞机</strong>：我梦见，我去谷歌写JVM了，给你们公司用，之后蹦了，让我起来改bug！</p> <p><strong>面试官</strong>：啊！？啊，那我问你，JDK 1.8 与 JDK 1.7 在运行时数据区的设计上，你都怎么做的优化策略的？</p> <p><strong>谢飞机</strong>：我没写这，我不知道！</p> <p><strong>面试官</strong>：擦。。。</p> <h2 id="三、-jdk1-6、jdk1-7、jdk1-8-内存模型演变"><a href="#三、-jdk1-6、jdk1-7、jdk1-8-内存模型演变" class="header-anchor">#</a> 三、 JDK1.6、JDK1.7、JDK1.8 内存模型演变</h2> <p><img alt="图 25-1  JDK1.6、JDK1.7、JDK1.8，内存模型演变" data-src="https://bugstack.cn/assets/images/2020/interview/interview-25-1.png" loading="lazy" class="lazy"></p> <p>如图 25-1 是 JDK 1.6、1.7、1.8 的内存模型演变过程，其实这个内存模型就是 JVM 运行时数据区依照JVM虚拟机规范的具体实现过程。</p> <p>在图 25-1 中各个版本的迭代都是为了更好的适应CPU性能提升，最大限度提升的JVM运行效率。这些版本的JVM内存模型主要有以下差异：</p> <ul><li>JDK 1.6：有永久代，静态变量存放在永久代上。</li> <li>JDK 1.7：有永久代，但已经把字符串常量池、静态变量，存放在堆上。逐渐的减少永久代的使用。</li> <li>JDK 1.8：无永久代，运行时常量池、类常量池，都保存在元数据区，也就是常说的<code>元空间</code>。但字符串常量池仍然存放在堆上。</li></ul> <h2 id="四、内存模型各区域介绍"><a href="#四、内存模型各区域介绍" class="header-anchor">#</a> 四、内存模型各区域介绍</h2> <h3 id="_1-程序计数器"><a href="#_1-程序计数器" class="header-anchor">#</a> 1. 程序计数器</h3> <ul><li>较小的内存空间、线程私有，记录当前线程所执行的字节码行号。</li> <li>如果执行 Java 方法，计数器记录虚拟机字节码当前指令的地址，本地方法则为空。</li> <li>这一块区域没有任何 OutOfMemoryError 定义。</li></ul> <p><strong>以上</strong>，就是关于程序计数器的定义，如果这样看没有感觉，我们举一个例子。</p> <p>定义一段 Java 方法的代码，这段代码是计算圆形的周长。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">float</span> <span class="token function">circumference</span><span class="token punctuation">(</span><span class="token keyword">float</span> r<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">float</span> pi <span class="token operator">=</span> <span class="token number">3.14f</span><span class="token punctuation">;</span>
        <span class="token keyword">float</span> area <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> r<span class="token punctuation">;</span>
        <span class="token keyword">return</span> area<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>接下来，如图 25-2 是这段代码的在虚拟机中的执行过程，左侧是它的程序计数器对应的行号。</p> <p><img alt="图 25-2 程序计数器" data-src="https://bugstack.cn/assets/images/2020/interview/interview-25-2.png" loading="lazy" class="lazy"></p> <ul><li>这些行号每一个都会对应一条需要执行的字节码指令，是压栈还是弹出或是执行计算。</li> <li>之所以说是线程私有的，因为如果不是私有的，那么整个计算过程最终的结果也将错误。</li></ul> <h3 id="_2-java虚拟机栈"><a href="#_2-java虚拟机栈" class="header-anchor">#</a> 2. Java虚拟机栈</h3> <ul><li>每一个方法在执行的同时，都会创建出一个栈帧，用于存放局部变量表、操作数栈、动态链接、方法出口、线程等信息。</li> <li>方法从调用到执行完成，都对应着栈帧从虚拟机中入栈和出栈的过程。</li> <li>最终，栈帧会随着方法的创建到结束而销毁。</li></ul> <p>可能这么只从定义看上去仍然没有什么感觉，我们再找一个例子。</p> <p>这是一个关于<code>斐波那契数列（Fibonacci sequence）</code>求值的例子，我们通过斐波那契数列在虚拟机中的执行过程，来体会Java虚拟机栈的用途。</p> <blockquote><p>斐波那契数列（Fibonacci sequence），又称黄金分割数列、因数学家列昂纳多·斐波那契（Leonardoda Fibonacci）以兔子繁殖为例子而引入，故又称为“兔子数列”，指的是这样一个数列：1、1、2、3、5、8、13、21、34、……在数学上，斐波纳契数列以如下被以递推的方法定义：F(1)=1，F(2)=1, F(n)=F(n-1)+F(n-2)（n&gt;=3，n∈N*）在现代物理、准晶体结构、化学等领域，斐波纳契数列都有直接的应用，为此，美国数学会从1963年起出版了以《斐波纳契数列季刊》为名的一份数学杂志，用于专门刊载这方面的研究成果。</p></blockquote> <p><img alt="图 25-3 斐波那契数列在虚拟机栈中的执行过程" data-src="https://bugstack.cn/assets/images/2020/interview/interview-25-3.png" loading="lazy" class="lazy"></p> <ul><li>整个这段流程，就是方法的调用和返回。在调用过程申请了操作数栈的深度和局部变量的大小。</li> <li>以及相应的信息从各个区域获取并操作，其实也就是入栈和出栈的过程。</li></ul> <h3 id="_3-本地方法栈"><a href="#_3-本地方法栈" class="header-anchor">#</a> 3. 本地方法栈</h3> <ul><li>本地方法栈与Java虚拟机栈作用类似，唯一不同的就是本地方法栈执行的是Native方法，而虚拟机栈是为JVM执行Java方法服务的。</li> <li>另外，与 Java 虚拟机栈一样，本地方法栈也会抛出 StackOverflowError 和 OutOfMemoryError 异常。</li> <li>JDK1.8 HotSpot虚拟机直接就把本地方法栈和虚拟机栈合二为一。</li></ul> <p><em>关于本地方法栈在以上的例子已经涉及了这部分内容，这里就不在赘述了。</em></p> <h3 id="_4-堆和元空间"><a href="#_4-堆和元空间" class="header-anchor">#</a> 4. 堆和元空间</h3> <p><img alt="图 25-4 Java 堆区域划分" data-src="https://bugstack.cn/assets/images/2020/interview/interview-25-4.png" loading="lazy" class="lazy"></p> <ul><li>JDK 1.8 JVM 的内存结构主要由三大块组成：堆内存、元空间和栈，Java 堆是内存空间占据最大的一块区域。</li> <li>Java 堆，由年轻代和年老代组成，分别占据1/3和2/3。</li> <li>而年轻代又分为三部分，<strong>Eden</strong>、<strong>From Survivor</strong>、<strong>To Survivor</strong>，占据比例为8:1:1，可调。</li> <li>另外这里我们特意画出了元空间，也就是直接内存区域。在 JDK 1.8 之后就不在堆上分配方法区了。</li> <li><strong>元空间</strong>从虚拟机Java堆中转移到本地内存，默认情况下，元空间的大小仅受本地内存的限制，说白了也就是以后不会因为永久代空间不够而抛出OOM异常出现了。<em>jdk1.8以前版本的 class和JAR包数据存储在 PermGen下面 ，PermGen 大小是固定的，而且项目之间无法共用，公有的 class，所以比较容易出现OOM异常。</em></li> <li>升级 JDK 1.8后，元空间配置参数，<code>-XX:MetaspaceSize=512M XX:MaxMetaspaceSize=1024M</code>。教你个小技巧通过jps、jinfo查看元空间，如下：
<ul><li><img alt="通过命令查看元空间" data-src="https://bugstack.cn/assets/images/2020/interview/interview-25-4-1.png" loading="lazy" class="lazy"></li> <li>通过jinfo查看默认MetaspaceSize大小（约20M）,MaxMetaspaceSize比较大。</li></ul></li></ul> <p><strong>其他：关于 JDK1.8 元空间的介绍：</strong> Move part of the contents of the permanent generation in Hotspot to the Java heap and the remainder to native memory. <a href="http://openjdk.java.net/jeps/122" target="_blank" rel="noopener noreferrer">http://openjdk.java.net/jeps/122<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_5-常量池"><a href="#_5-常量池" class="header-anchor">#</a> 5. 常量池</h3> <ul><li>从 JDK 1.7开始把常量池从永久代中剥离，直到 JDK1.8 去掉了永久代。而字符串常量池一直放在堆空间，用于存储字符串对象，或是字符串对象的引用。</li></ul> <h2 id="五、手撸虚拟机-内存模型"><a href="#五、手撸虚拟机-内存模型" class="header-anchor">#</a> 五、手撸虚拟机(内存模型)</h2> <p>其实以上的内容，已经完整的介绍了JVM虚拟机的内存模型，也就是运行时数据区的结构。但是这东西看完可能就忘记了，因为缺少一个可亲手操作的代码。</p> <p><strong>所以</strong>，这里我给大家用Java代码写一段关于数据槽、栈帧、局部变量、虚拟机栈以及堆的代码结构，让大家更好的加深对虚拟机内存模型的印象。</p> <h3 id="_1-工程结构"><a href="#_1-工程结构" class="header-anchor">#</a> 1. 工程结构</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>运行时数据区
├── heap
│   ├── constantpool
│   ├── methodarea
│   │   ├── <span class="token class-name">Class</span><span class="token punctuation">.</span>java
│   │   ├── <span class="token class-name">ClassMember</span><span class="token punctuation">.</span>java
│   │   ├── <span class="token class-name">Field</span><span class="token punctuation">.</span>java
│   │   ├── <span class="token class-name">Method</span><span class="token punctuation">.</span>java
│   │   ├── <span class="token class-name">MethodDescriptor</span><span class="token punctuation">.</span>java
│   │   ├── <span class="token class-name">MethodDescriptorParser</span><span class="token punctuation">.</span>java
│   │   ├── <span class="token class-name">MethodLookup</span><span class="token punctuation">.</span>java
│   │   ├── <span class="token class-name">Object</span><span class="token punctuation">.</span>java
│   │   ├── <span class="token class-name">Slots</span><span class="token punctuation">.</span>java
│   │   └── <span class="token class-name">StringPool</span><span class="token punctuation">.</span>java
│   └── <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span>java
├── <span class="token class-name">Frame</span><span class="token punctuation">.</span>java
├── <span class="token class-name">JvmStack</span><span class="token punctuation">.</span>java
├── <span class="token class-name">LocalVars</span><span class="token punctuation">.</span>java
├── <span class="token class-name">OperandStack</span><span class="token punctuation">.</span>java
├── <span class="token class-name">Slot</span><span class="token punctuation">.</span>java
└── <span class="token class-name">Thread</span><span class="token punctuation">.</span>java
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>以上这部分就是使用Java实现的部分JVM虚拟机功能，这部分主要包括如下内容：</p> <ul><li>Frame，栈帧</li> <li>JvmStack，虚拟机栈</li> <li>LocalVars，局部变量</li> <li>OperandStack，操作数栈</li> <li>Slot，数据槽</li> <li>Thread，线程</li> <li>heap，堆，里面包括常量池和方法区</li></ul> <h3 id="_2-重点代码"><a href="#_2-重点代码" class="header-anchor">#</a> 2. 重点代码</h3> <p><strong>操作数栈 OperandStack</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OperandStack</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Slot</span><span class="token punctuation">[</span><span class="token punctuation">]</span> slots<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">OperandStack</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxStack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>maxStack <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            slots <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Slot</span><span class="token punctuation">[</span>maxStack<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> maxStack<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                slots<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Slot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>虚拟机栈 OperandStack</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JvmStack</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> maxSize<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Frame</span> _top<span class="token punctuation">;</span>
    
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>栈帧 Frame</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Frame</span> <span class="token punctuation">{</span>

    <span class="token comment">//stack is implemented as linked list</span>
    <span class="token class-name">Frame</span> lower<span class="token punctuation">;</span>

    <span class="token comment">//局部变量表</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalVars</span> localVars<span class="token punctuation">;</span>

    <span class="token comment">//操作数栈</span>
    <span class="token keyword">private</span> <span class="token class-name">OperandStack</span> operandStack<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Thread</span> thread<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Method</span> method<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> nextPC<span class="token punctuation">;</span>
 
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li>关于代码结构看到这有点感觉了吗？</li> <li>Slot数据槽，就是一个数组结构，用于存放数据的。</li> <li>操作数栈、局部变量表，都是使用数据槽进行入栈入栈操作。</li> <li>在栈帧里，可以看到连接、局部变量表、操作数栈、方法、线程等，那么文中说到的当有一个新的<code>每一个方法在执行的同时，都会创建出一个栈帧</code>，是不就对了上，可以真的理解了。</li> <li>如果你对JVM的实现感兴趣，可以阅读<code>用Java实现JVM源码</code>：<a href="https://github.com/fuzhengwei/itstack-demo-jvm" target="_blank" rel="noopener noreferrer">https://github.com/fuzhengwei/itstack-demo-jvm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="六、jconsole监测元空间溢出"><a href="#六、jconsole监测元空间溢出" class="header-anchor">#</a> 六、jconsole监测元空间溢出</h2> <p>不是说 JDK 1.8 的内存模型把永久代下掉，换上<code>元空间</code>了吗？但不测试下，就感受不到呀，没有证据！</p> <p>所有关于代码逻辑的学习，都需要有数据基础和证明过程，这样才能有深刻的印象。走着，带你把元空间干满，让它OOM！</p> <h3 id="_1-找段持续创建大对象的代码"><a href="#_1-找段持续创建大对象的代码" class="header-anchor">#</a> 1. 找段持续创建大对象的代码</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    
    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">ClassLoadingMXBean</span> loadingBean <span class="token operator">=</span> <span class="token class-name">ManagementFactory</span><span class="token punctuation">.</span><span class="token function">getClassLoadingMXBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Enhancer</span> enhancer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Enhancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        enhancer<span class="token punctuation">.</span><span class="token function">setSuperclass</span><span class="token punctuation">(</span><span class="token class-name">MetaSpaceOomMock</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        enhancer<span class="token punctuation">.</span><span class="token function">setCallbackTypes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">Dispatcher</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">MethodInterceptor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        enhancer<span class="token punctuation">.</span><span class="token function">setCallbackFilter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CallbackFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">Method</span> method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>enhancer<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> loadingBean<span class="token punctuation">.</span><span class="token function">getTotalLoadedClassCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> loadingBean<span class="token punctuation">.</span><span class="token function">getLoadedClassCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> loadingBean<span class="token punctuation">.</span><span class="token function">getUnloadedClassCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ul><li>网上找了一段基于CGLIB的，你可以写一些其他的。</li> <li><code>Thread.sleep(5000);</code>，睡一会，方便我们点检测，要不程序太快就异常了。</li></ul> <h3 id="_2-调整元空间大小"><a href="#_2-调整元空间大小" class="header-anchor">#</a> 2. 调整元空间大小</h3> <p>默认情况下元空间太大了，不方便测试出结果，所以我们把它调的小一点。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token operator">-</span><span class="token constant">XX</span><span class="token operator">:</span><span class="token class-name">MetaspaceSize</span><span class="token operator">=</span><span class="token number">8</span>m
<span class="token operator">-</span><span class="token constant">XX</span><span class="token operator">:</span><span class="token class-name">MaxMetaspaceSize</span><span class="token operator">=</span><span class="token number">80</span>m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_3-设置监控参数"><a href="#_3-设置监控参数" class="header-anchor">#</a> 3. 设置监控参数</h3> <p>基于 jconsole 监控，我们需要设置下参数。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token operator">-</span><span class="token class-name">Djava</span><span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>server<span class="token punctuation">.</span>hostname<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
<span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote
<span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token punctuation">.</span>port<span class="token operator">=</span><span class="token number">7397</span>
<span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token punctuation">.</span>ssl<span class="token operator">=</span><span class="token boolean">false</span>
<span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token punctuation">.</span>authenticate<span class="token operator">=</span><span class="token boolean">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_4-测试运行"><a href="#_4-测试运行" class="header-anchor">#</a> 4. 测试运行</h3> <h4 id="_4-1-配置参数"><a href="#_4-1-配置参数" class="header-anchor">#</a> 4.1 配置参数</h4> <p><strong>以上的测试参数</strong>，配置到IDEA中运行程序里就可以，如下：</p> <p><img alt="图 25-5 设置程序运行参数，监控OOM" data-src="https://bugstack.cn/assets/images/2020/interview/interview-25-5.png" loading="lazy" class="lazy"></p> <p>另外，jconsole 可以通过 IDEA 提供的 Terminal 启动，直接输入 <code>jconsole</code>，回车即可。</p> <h4 id="_4-2-测试结果"><a href="#_4-2-测试结果" class="header-anchor">#</a> 4.2 测试结果</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>interview<span class="token punctuation">.</span></span>MetaSpaceOomMock</span>$$<span class="token class-name">EnhancerByCGLIB</span>$$bd2bb16e999099900
<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>interview<span class="token punctuation">.</span></span>MetaSpaceOomMock</span>$$<span class="token class-name">EnhancerByCGLIB</span>$$<span class="token number">9</span>c774e64999199910
<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>interview<span class="token punctuation">.</span></span>MetaSpaceOomMock</span>$$<span class="token class-name">EnhancerByCGLIB</span>$$cac97732999299920
<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>interview<span class="token punctuation">.</span></span>MetaSpaceOomMock</span>$$<span class="token class-name">EnhancerByCGLIB</span>$$<span class="token number">91</span>c6a15a999399930
<span class="token class-name">Exception</span> in thread <span class="token string">&quot;main&quot;</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>IllegalStateException</span><span class="token operator">:</span> <span class="token class-name">Unable</span> <span class="token keyword">to</span> <span class="token namespace">load</span> cache item
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span>LoadingCache</span><span class="token punctuation">.</span><span class="token function">createEntry</span><span class="token punctuation">(</span><span class="token class-name">LoadingCache</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">79</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span>LoadingCache</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">LoadingCache</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">34</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span>AbstractClassGenerator</span>$<span class="token class-name">ClassLoaderData</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">AbstractClassGenerator</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">119</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span>AbstractClassGenerator</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">AbstractClassGenerator</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">294</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span></span>Enhancer</span><span class="token punctuation">.</span><span class="token function">createHelper</span><span class="token punctuation">(</span><span class="token class-name">Enhancer</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">480</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span></span>Enhancer</span><span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token class-name">Enhancer</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">337</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>itstack<span class="token punctuation">.</span>interview<span class="token punctuation">.</span></span>MetaSpaceOomMock</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">MetaSpaceOomMock</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">34</span><span class="token punctuation">)</span>
<span class="token class-name">Caused</span> by<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>OutOfMemoryError</span><span class="token operator">:</span> <span class="token class-name">Metaspace</span>
	at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Class</span><span class="token punctuation">.</span><span class="token function">forName0</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">348</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span>ReflectUtils</span><span class="token punctuation">.</span><span class="token function">defineClass</span><span class="token punctuation">(</span><span class="token class-name">ReflectUtils</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">467</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span>AbstractClassGenerator</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token class-name">AbstractClassGenerator</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">339</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span></span>Enhancer</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token class-name">Enhancer</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">492</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span>AbstractClassGenerator</span>$<span class="token class-name">ClassLoaderData</span>$<span class="token number">3.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token class-name">AbstractClassGenerator</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">96</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span>AbstractClassGenerator</span>$<span class="token class-name">ClassLoaderData</span>$<span class="token number">3.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token class-name">AbstractClassGenerator</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">94</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span>LoadingCache</span>$<span class="token number">2.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token class-name">LoadingCache</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">54</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span>FutureTask</span><span class="token punctuation">.</span>run$$$<span class="token function">capture</span><span class="token punctuation">(</span><span class="token class-name">FutureTask</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">266</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span>FutureTask</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">FutureTask</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span>LoadingCache</span><span class="token punctuation">.</span><span class="token function">createEntry</span><span class="token punctuation">(</span><span class="token class-name">LoadingCache</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">61</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">6</span> more
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><ul><li>要的就是这句，java.lang.OutOfMemoryError: Metaspace，元空间OOM，证明 JDK1.8 已经去掉永久代，换位元空间。</li></ul> <h4 id="_4-3-监控截图"><a href="#_4-3-监控截图" class="header-anchor">#</a> 4.3 监控截图</h4> <p><img alt="图 25-6 jconsole监测元空间溢出" data-src="https://bugstack.cn/assets/images/2020/interview/interview-25-6.png" loading="lazy" class="lazy"></p> <ul><li>图 25-6，就是监测程序OOM时的元空间表现。这回对这个元空间就有感觉了吧！</li></ul> <h2 id="七、总结"><a href="#七、总结" class="header-anchor">#</a> 七、总结</h2> <ul><li>本文从 JDK 各个版本关于内存模型结构的演变，来了解各个区域，包括：程序计数器、Java 虚拟机栈、本地方法栈、堆和元空间。并了解从 JDK 1.8 开始去掉方法区引入元空间的核心目的和作用。</li> <li>在通过手撸JVM代码的方式让大家对运行时数据区有一个整体的认知，也通过这样的方式让大家对学习这部分知识有一个抓手。</li> <li>最后我们通过 jconsole 检测元空间溢出的整个过程，来学以致用，看看元空间到底在解决什么问题以及怎么测试。</li></ul></div> <footer class="page-edit"><div class="edit-link"><a rel="noopener noreferrer"> aaaa </a></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/md/java/interview/2020-12-30-面经手册 · 第24篇《为了搞清楚类加载，竟然手撸JVM！》.html" class="prev">
          面经手册 · 第24篇《为了搞清楚类加载，竟然手撸JVM！》
        </a></span> <span class="next"><a href="/md/java/interview/2021-01-13-面经手册 · 第26篇《JVM故障处理工具，使用总结》.html">
          面经手册 · 第26篇《JVM故障处理工具，使用总结》
        </a>
        →
      </span></p></div> </main></div> <aside class="page-sidebar"> <div class="page-side-toolbar"><div class="option-box-toc-fixed"><div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:650px"><div style="font-weight:bold;text-align:center;">面经手册 · 第25篇《JVM内存模型总结，有各版本JDK对比、有元空间OOM监控案例、有Java版虚拟机，综合学习更容易！》</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#一、前言" class="toc-sidebar-link">一、前言</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#二、面试题" class="toc-sidebar-link">二、面试题</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#三、-jdk1-6、jdk1-7、jdk1-8-内存模型演变" class="toc-sidebar-link">三、 JDK1.6、JDK1.7、JDK1.8 内存模型演变</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#四、内存模型各区域介绍" class="toc-sidebar-link">四、内存模型各区域介绍</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_1-程序计数器" class="toc-sidebar-link">1. 程序计数器</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_2-java虚拟机栈" class="toc-sidebar-link">2. Java虚拟机栈</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_3-本地方法栈" class="toc-sidebar-link">3. 本地方法栈</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_4-堆和元空间" class="toc-sidebar-link">4. 堆和元空间</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_5-常量池" class="toc-sidebar-link">5. 常量池</a></li></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#五、手撸虚拟机-内存模型" class="toc-sidebar-link">五、手撸虚拟机(内存模型)</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_1-工程结构" class="toc-sidebar-link">1. 工程结构</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_2-重点代码" class="toc-sidebar-link">2. 重点代码</a></li></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#六、jconsole监测元空间溢出" class="toc-sidebar-link">六、jconsole监测元空间溢出</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_1-找段持续创建大对象的代码" class="toc-sidebar-link">1. 找段持续创建大对象的代码</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_2-调整元空间大小" class="toc-sidebar-link">2. 调整元空间大小</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_3-设置监控参数" class="toc-sidebar-link">3. 设置监控参数</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_4-测试运行" class="toc-sidebar-link">4. 测试运行</a></li></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#七、总结" class="toc-sidebar-link">七、总结</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div> <div class="option-box-toc-over"><img src="/images/system/toc.png" class="nozoom"> <span class="show-txt">目录</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:550px"><div style="font-weight:bold;text-align:center;">面经手册 · 第25篇《JVM内存模型总结，有各版本JDK对比、有元空间OOM监控案例、有Java版虚拟机，综合学习更容易！》</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#一、前言" class="toc-sidebar-link">一、前言</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#二、面试题" class="toc-sidebar-link">二、面试题</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#三、-jdk1-6、jdk1-7、jdk1-8-内存模型演变" class="toc-sidebar-link">三、 JDK1.6、JDK1.7、JDK1.8 内存模型演变</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#四、内存模型各区域介绍" class="toc-sidebar-link">四、内存模型各区域介绍</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_1-程序计数器" class="toc-sidebar-link">1. 程序计数器</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_2-java虚拟机栈" class="toc-sidebar-link">2. Java虚拟机栈</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_3-本地方法栈" class="toc-sidebar-link">3. 本地方法栈</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_4-堆和元空间" class="toc-sidebar-link">4. 堆和元空间</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_5-常量池" class="toc-sidebar-link">5. 常量池</a></li></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#五、手撸虚拟机-内存模型" class="toc-sidebar-link">五、手撸虚拟机(内存模型)</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_1-工程结构" class="toc-sidebar-link">1. 工程结构</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_2-重点代码" class="toc-sidebar-link">2. 重点代码</a></li></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#六、jconsole监测元空间溢出" class="toc-sidebar-link">六、jconsole监测元空间溢出</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_1-找段持续创建大对象的代码" class="toc-sidebar-link">1. 找段持续创建大对象的代码</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_2-调整元空间大小" class="toc-sidebar-link">2. 调整元空间大小</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_3-设置监控参数" class="toc-sidebar-link">3. 设置监控参数</a></li><li class="toc-sidebar-sub-header"><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#_4-测试运行" class="toc-sidebar-link">4. 测试运行</a></li></ul></li><li><a href="/md/java/interview/2021-01-06-%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C%20%C2%B7%20%E7%AC%AC25%E7%AF%87%E3%80%8AJVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93%EF%BC%8C%E6%9C%89%E5%90%84%E7%89%88%E6%9C%ACJDK%E5%AF%B9%E6%AF%94%E3%80%81%E6%9C%89%E5%85%83%E7%A9%BA%E9%97%B4OOM%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E3%80%81%E6%9C%89Java%E7%89%88%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%8C%E7%BB%BC%E5%90%88%E5%AD%A6%E4%B9%A0%E6%9B%B4%E5%AE%B9%E6%98%93%EF%BC%81%E3%80%8B.html#七、总结" class="toc-sidebar-link">七、总结</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div> <div class="option-box"><img src="/images/system/github.png" width="28px" class="nozoom"> <span class="show-txt">Github</span></div> <div class="option-box"><img src="/images/system/gitee.png" width="28px" class="nozoom"> <span class="show-txt">Gitee</span></div> <div class="option-box"><img src="/images/system/left.png" width="28px" class="nozoom"> <span class="show-txt">左栏</span></div> <div title="面经手册 · 第24篇《为了搞清楚类加载，竟然手撸JVM！》" class="option-box" style="padding-left:2px;text-align:center;"><a href="/md/java/interview/2020-12-30-面经手册 · 第24篇《为了搞清楚类加载，竟然手撸JVM！》.html"><img src="/images/system/prev.png" width="28px" class="nozoom"> <span class="show-txt">上一篇</span></a></div> <div title="面经手册 · 第26篇《JVM故障处理工具，使用总结》" class="option-box" style="padding-left:2px;text-align:center;"><a href="/md/java/interview/2021-01-13-面经手册 · 第26篇《JVM故障处理工具，使用总结》.html"><img src="/images/system/next.png" width="28px" class="nozoom"> <span class="show-txt">下一篇</span></a></div></div>  <!----> </aside></div><div class="global-ui"><LockArticle></LockArticle><PayArticle></PayArticle></div></div>
    <script src="/assets/js/cg-styles.js?v=1686664442105" defer></script><script src="/assets/js/cg-3.js?v=1686664442105" defer></script><script src="/assets/js/cg-4.js?v=1686664442105" defer></script><script src="/assets/js/cg-55.js?v=1686664442105" defer></script><script src="/assets/js/cg-app.js?v=1686664442105" defer></script>
  </body>
</html>
